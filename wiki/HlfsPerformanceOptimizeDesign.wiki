#summary HLFS性能优化设计草案.

= Introduction =
{{{
HLFS性能优化至关重要，是HLFS成败的关键之笔，本文首先分析HLFS性能优化因素，然后给出HLFS性能优化实施方案和可能
用到的工具，最后提出了HLFS性能优化之后需要达到的预期目标。
}}}

=HLFS性能优化因素=
{{{
下面简单的描述一下HLFS性能优化的出发点。

1， 段文件大小，越大越好（也有上线），因为段文件如果小了，
会导致段文件open,close等操作，降低效率。

2， 数据块大小，越大越好（也有上线），因为hdfs每次写入都是
大数据，数据块越大操作越方便，效率也会提高。若要对小数据进行
修改和读取，那么我们依赖于cache来提高性能。

3， cache大小，越大越好（有上线），cache有安全性问题，因为
随时可能会岩机导致数据丢失，但是正常情况cache大了可以极大
提高I/O性能，这也是我们提高HLFS性能最核心的部分。

4， 段回收机制，这一阶段先不关闭段回收机制，下阶段单独优化，因为
垃圾数据的回收机制比较复杂，牵扯到GC算法等问题。

5， HDFS参数， 牵扯到hdfs本地化问题，hdfs配置文件参数问题，hdfs
集群大小问题等等。


HLFS性能优化第一阶段先就以上问题进行优化。
}}}

=HLFS性能优化具体实施步骤=
{{{
1， 设计性能测试矩阵
2， 根据设计矩阵部署环境
3， 得出对应测试矩阵下的测试数据
4， 重复1---3，并进行对比，得出一次场景下的测试结论

                        Test Matrix 1 of HLFS
硬件参数	廉价pc，处理器：Pentium(R) Dual-Core CPU E2210 @ 2.2GHZ (2 Cpus); 内存：2038MB
软件参数	Distributor ID:	Ubuntu
Description:	Ubuntu 12.04.2 LTS
Release:	12.04
Codename:	precise
HDFS参数	三台pc上搭建hdfs完全分布式环境(一个namenode, 两个datanode)；
Hdfs文件配置参数待定；
HLFS段文件大小	HLFS段文件大小为64MB
HLFS数据块大小	HLFS数据块大小为8KB
HLFS cache 大小	待定
测试结果	待定
测试结论	待定
测试人及时间	贾威威 2013，4, 3
备注	这个HLFS性能测试矩阵只是例子，这个阶段测试需要先关闭HLFS段回收机制。
}}}

=HLFS性能优化可能需要用到的tools=
{{{
1, fio，详见
http://freecode.com/projects/fio
http://git.kernel.dk/

2, 其他一些I/O性能分析工具等等
}}}

=HLFS性能优化总结和预期优化目标=
{{{
HLFS最终I/O性能要达到hdfs的%80---%90, 若达不到,我们
则要重构HLFS。我们还要给出HLFS在不同场景下的性能最
大化参数矩阵，方便用户配置和使用。
}}}

----
Written by Harry Wei <harryxiyou@gmail.com>